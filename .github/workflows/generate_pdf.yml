on: [push]

jobs:
  latex-job:
    runs-on: ubuntu-latest
    
    name: Compile And Upload PDF

    steps:
    - name: Checkout
      uses: actions/checkout@v2

    - name: Cached Infra
      uses: actions/cache@v2
      env:
        cache-name: cached-tectonic
      with:
        path: |
          ~/.cache
        key: ${{ env.cache-name }}-${{ hashFiles('.cachefile') }}
        restore-keys: |
          ${{ env.cache-name }}-

    - name: LaTeX Compilation
      uses: vinay0410/tectonic-action@v1.1.2
      with:
        tex_path: 'hm.tex'
        push: 'no'
    
    - name: Upload PDF
      if: ${{ success() }}
      uses: actions/upload-artifact@v2
      with:
        path: hm.pdf
        name: hm.pdf
        if-no-files-found: error
